---
title: "ETC5521 Assignment 1"
subtitle: "Contribution of domestic clubs towards world cup success in women's soccer"
team: wattle
author:
  - Ketan Kabu  31554679
  - Yiwen Zhang 31203019
date: "`r Sys.Date()`"
bibliography: references.bib
biblio-style: authoryear-comp
output: 
  bookdown::html_document2:
   citation_package: biblatex
   toc: TRUE
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=TRUE, message=FALSE,warning = FALSE,comment = FALSE,fig.pos = 'H')

library(ggplot2)
library(tidyverse)
library(dplyr)
library(plotly)
library(bookdown)
library(ggridges)
library(colorspace)
library(plotly)
library(GGally)
library(kableExtra)
```

```{r readdata}
wwc_outcomes <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-09/wwc_outcomes.csv")
squads <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-09/squads.csv")
codes <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-09/codes.csv")

df <- read.csv("https://query.data.world/s/va6hy244mzxtoc7c3ww3nracqhreab", header=TRUE, stringsAsFactors=FALSE)
```




# Introduction and motivation

Women's soccer has gained a lot of media attention in the last few years, and deservingly so. Countries like the USA, a dominant force in women's soccer, have produced some top quality players like Megan Rapinoe, Carli Lloyd, Alex Morgan and Julie Ertz. Just north of the USA, Christine Sinclair from Canada became the first player to win the Lou Marsh Award as Canadian Athlete of the Year, which is unsurprising considering her outstanding haul of 182 career international goals. Ada Hegerberg from Norway became the first woman to win the prestigious Ballon d'Or award, an yearly honor awarded to best player in the world, which was first introduced for the women's game in 2018.[@sportmob2020]

The advancement of women's soccer has been parallel with the understanding and acceptance of data and analytics in the game. The technological advancement in capturing and analysing data has exploded since the late 1990s, when it began. Clubs have used this technology to identify and scout talent from all over the world.

Every country has a different approach towards coaching and developing talent. Success at an international level could be down to the ability of world class players playing with a certain level of chemistry, which could be challenging as it is common for them to be playing for different rival clubs at the domestic level. In the men's game, we saw Italy, Spain and Germany winning world cups in 2006, 2010 and 2014 respectively. Many partly attributed the success of these teams towards the fact that majority of these players playing in the same domestic league (or country), or even in the same club, especially those clubs that produce the most successful international players.

In this paper, we will approach the women's game with the same lens. We believe that these findings could prove meaningful to coaches, scouts and even young players in the game looking to choose clubs to play for with future international success in mind.

Limitations - The squad data that we had access to had only the 2019 world cup team rosters, which is why we could only focus on the 2019 world cup matches. If similar dataset for all world cups is obtained, analysis can be done on all world cups and a trend observation can produce deeper insights about how nations have progressed in women's soccer. 
There is also a need to assess players' performance not solely on the basis of goals they scored. Midfielders, Defenders and Goalkeepers have various other parameters they can be judged on - like assists, distance covered in a match, tackles, clearances, saves(goalkeepers) and various others. If this information is available, better player performance insights can be achieved. 
We could also do match by match analysis of the world cup if we can obtain information about how each player was rated, or scored certain number of goals, in a world cup match.
In our clubs data, we have a reference named as "Unattached", which will appear sometimes in our analysis. This signifies that the player(s) is not contracted with any domestic club when the data was collected.


# Data description

This dataset is about Women's World Cup, which originally comes from website data.world <https://data.world/sportsvizsunday/womens-world-cup-data>.It consists of final score and win/loss status data from 1991-2019. Additionally, the 2019 world cup rosters for each team are included. After being cleaned by a data analyst, we downloaded the data from his github <https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-07-09>. Figure \@ref(fig:miss-data) shows the missing data for squads.

```{r outcome-data, warning=FALSE, message=FALSE}
outcome_data <- tibble(Variable = c("year", "team", "score", "round", "yearly_game_id","team_num","win_status"),
                          Class = c( "double",  "character", "double","character", "integer", "double",  "character"),
                          Description = c("Year of tournamente", 
                                          "Abbreviated team", 
                                          "Score by team", 
                                          "Round of the tournament", 
                                          "Grouping variable - pairs team 1 and team 2 by round/year","team num (1 or 2)","Win Status = win/lose or tie (group only)")) 
outcome_data %>%
  kable(caption = "Woman world cup outcome data") %>%
  kable_styling(bootstrap_options = "striped", 
                full_width = F, 
                position = "center")
```

```{r outcome-data, warning=FALSE, message=FALSE}
squads_data <- tibble(Variable = c("squad_no", "country", "pos", "player", "dob","age","caps","goals","club"),
                          Class = c( "double",  "character","character","character", "date", "double", "double","double", "character"),
                          Description = c("Squad number (1 through 23)", 
                                          "Country", 
                                          "position", 
                                          "Player name", 
                                          "date of birth",
                                          "age (years)",
                                          "caps - international games played","Goals - international goals scored","Professional Club")) 
squads_data %>%
  kable(caption = "squads data") %>%
  kable_styling(bootstrap_options = "striped", 
                full_width = F, 
                position = "center")
```

```{r miss-data,fig.cap="Missing data for squads"}
visdat::vis_miss(squads)
```
# Analysis and findings

Main question:

- What factor affect the performance of the football team in the world cup?

The analysis is mainly divided into three parts, which answer the three secondary questions, and they are :
- Which are the clubs that provide the most number of world cup players?

- How about contribution by clubs in terms of players' caps and positions?

- How is the performance of successful clubs in the 2019 World Cup?


## Analysis the performance of woman world cup by country
### Overall summary trend of the number of goals scored by the country
```{r score-dis,fig.cap="Nation goals distribution"}
wwc_outcomes_2019 <- wwc_outcomes %>% 
  group_by(team,year) %>% 
  summarise(score = sum(score))
  
p1 <- ggplot(wwc_outcomes_2019, aes(score, team)) +  
  geom_density_ridges() + 
  geom_point() + 
  labs(y = "Country", x= "score")+
  theme(axis.text.y = element_text(color = "grey",face = "bold"),
        plot.title = element_text(face = "bold"),
        plot.background = element_rect(fill="white"),
        panel.background = element_rect(fill="white"))
p1
```

Looking into figure \@ref(fig:score-dis), the USA and Germany score significantly more goals each year than other countries, the kurtosis reflects the central tendency. The more right the kurtosis, the more goals are scored. The point shows the total number of goals scored by different countries each year. It can be seen that the most happened in the United State.

```{r data-process}

  wwc_outcomes_ROUND <- wwc_outcomes%>% 
   mutate(Round = case_when(
      str_detect(round, "Group") ~ "G",
      str_detect(round, "Quarter Final") ~ "Q",
      str_detect(round, "Semi Final") ~ "S",
      str_detect(round, "Third Place Playoff") ~ "T",
      str_detect(round, "Final") ~ "F",
      str_detect(round, "Round of 16") ~ "R"
      )) 

```

### General summary of the promotion of the National Women's World Cup

```{r exp-layout, fig.width = 15, fig.height = 8, fig.cap = "Experimental layout. Each cell represents an experimental unit for each categorised behaviour. The number written in the cell shows the number of observations recorded and the color of the cell shows the treatment applied to the calve."}

options(repr.plot.width = 12, repr.plot.height = 18)
 wwc_outcomes_ROUND  %>% 
  ggplot(aes(year, Round),height = "120%") + 
  geom_tile(color = "black", aes(fill = win_status)) + 
  #geom_text(aes(label = Round)) + 
  #facet_wrap(~team) + 
  facet_wrap( ~team) +
  scale_fill_discrete_qualitative() + 
  scale_color_manual(values = c("black", "brown")) +
  coord_equal() + 
  theme_classic(base_size =12) + 
  guides(color = FALSE) + 
  labs(fill = "Win_status", y = "Round", x = "Year")
```
Figure \@ref(fig:exp-layout) show the promotion situation for all the country attend the woman world cup between 1991 and 2019, the color represents the win, lose or tie, Each row represents a different stage of the game, such as group matches, semi-finals or final. It is clear to see that the United States has only lost four times in the past 20 years, The United States is a strong opponent in the Women's World Cup, followed by Germany, Although the number of losses is greater than that of the United States, Germany has also won many times. Figure \@ref(fig:exp-layout clearly sees the situation of each country. It can be seen that in women's football, the strength of different countries is very different. Why does this happen? What factors affect this phenomenon?

## More score, more change to get the champion

### Total goals scored by different countries

```{r map-count, fig.cap = "Total goals scored by different countries"}

whole_code <- wwc_outcomes %>% 
  left_join(codes) %>% 
   # filter(round =="Group") %>% 
  mutate(country= as.character(country),
        country = if_else(country %in% c("China PR","Chinese Taipei"), "China", country),
        country = if_else(country %in% "United States", "USA", country),
        country = if_else(country %in% "England","UK", country),
        country = if_else(country %in% "Ivory Coast (Côte d'Ivoire)","Ivory Coast", country)) %>% 
  group_by(country) %>% 
  summarise(total_score = sum(score))
  
  
world_map <- map_data("world")

numofplayers <- world_map %>% 
  mutate(region = as.character(region)) %>% 
  left_join(whole_code,by = c("region"="country")) 
  

 
numofplayers[is.na(numofplayers)] <- 0

p2 <- ggplot(numofplayers, aes(long, lat, group = group,label = region))+
    geom_polygon(aes(fill = total_score ), color = "white")+
    scale_fill_viridis_c(option = "C")+
    theme_void()+
    labs(fill = "Total number of goals",
         title = "Number of goals with different countries")+
   theme(
    legend.position = c(.20, .30),
    legend.box.just = c("right","bottom"))+
   theme(axis.text.y = element_text(color = "grey", 
                                             face = "bold"),
        plot.title = element_text(face = "bold"),
        plot.background = element_rect(fill="white"),
        panel.background = element_rect(fill="white"))

ggplotly(p2)
```

Figure \@ref(fig:map-count) is an interactive map. Click on the location on the map, and we can see the country's name and the total number of goals scored in the World Cup. The color also indicates the number of goals. USA, Germany, and Norway those three countries have the most number of total goals, especially compared to other countries. Does the total number of goals have anything to do with the chance of winning the championship? Will the country with more goals win the game? 

### THe relationship between total score and chance of winning

```{r Correlation,fig.cap="Correlation analysis"}
new_num <- numofplayers %>% 
  select(region,total_score) %>% 
  filter(total_score >0) %>% 
  distinct()


new_wwc <- wwc_outcomes %>% 
  left_join(codes)%>% 

    mutate(country= as.character(country),
        country = if_else(country %in% c("China PR","Chinese Taipei"), "China", country),
        country = if_else(country %in% "United States", "USA", country),
        country = if_else(country %in% "England","UK", country),
        country = if_else(country %in% "Ivory Coast (Côte d'Ivoire)","Ivory Coast", country)) %>% 
    filter(win_status=="Won") %>% 
  filter(round == "Final") %>% 
  # 用胜利的次数作为表现好的体现
  group_by(country) %>% 
  summarise(total = sum(score)) %>% 
    
  left_join(new_num,by = c("country"="region")) %>% 
  select(-country)

p3 <- ggpairs(new_wwc, title="correlogram with ggpairs()") +
  theme(axis.text.y = element_text(color = "grey", 
                                             face = "bold"),
        plot.title = element_text(face = "bold"),
        plot.background = element_rect(fill="white"),
        panel.background = element_rect(fill="white"))

ggplotly(p3)

```

Figure \@ref(fig:Correlation) is a correlation analysis between total goals and change to win, The correlation coefficient is 0.768, which shows a positive correlation, that is, the more the total number of goals, the greater the chance of winning the championship.






## Clubs that provide the most number of world cup players:

### Overall contribution

Let us begin our analysis by understanding the overall contibution of world cup players by clubs around the world:

```{r player-contri}

wc_clubs_players <- squads %>% 
  group_by(club) %>%
  tally() %>% 
  arrange(desc(n))

wc_clubs_players <- wc_clubs_players %>% 
  rename(Players = n)

wc_clubs_players %>% 
  head(10) %>% 
  kable(booktabs = TRUE, caption = "Overall contibution of world cup players by clubs") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

```

Out of a total of 552 players that featured in the 2019 World Cup, it can be seen in Table \@ref(tab:player-contri) that 15 play domestic football in Barcelona (Spain), 14 play for Lyon (France) and 12 play for Chelsea (England). It is interesting to note that clubs with 11 or higher number in this table can play in a match with a squad that's comprised entirely of world cup internationals, greatly increasing the profile of their club's brand.

### Goal scorers

Now, let us look at the number of overall international goals scored by players that featured in the 2019 World Cup by clubs: 

```{r goal-contri}

wc_clubs_goals <- squads %>% 
  group_by(club) %>% 
  summarise(Goals = sum(goals)) %>% 
  arrange(desc(Goals))

wc_clubs_goals %>% 
  head(10) %>% 
  kable(booktabs = TRUE, caption = "Top Ten Clubs Providing Best Goal Scorers") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
  
```

Looking into Table \@ref(tab:goal-contri), Portland Thorns (247) and Orlando Pride (240) both are from the US. They make up for nearly 500 international goals between their players. Lyon (177), Arsenal (148), Barcelona (134) and Chelsea (133) make up the rest of the top 5 clubs. Let us deep dive into these teams and look into players that actually do the goal scoring.

```{r players-goals,fig.cap="Players v/s Goals Scored For International Team"}

players_goals <- squads %>% 
  group_by(club) %>% 
  mutate(Club_goals = sum(goals)) %>% 
  filter(Club_goals >= 133) %>% 
  arrange(desc(goals)) %>% 
  slice(1:5)


p1 <- players_goals %>% 
  ggplot(aes(player, goals, color = club, size = Club_goals)) + 
  geom_point() +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  xlab("Players") +
  ylab("Goals") +
  ggtitle("Players v/s Goals Scored For International Team") +
  labs(size = "", color = "")

ggplotly(p1) 
  
  
```

In Figure \@ref(fig:players-goals), we can see the number of international goals scored by players belonging to the top 6 clubs (colored) contributing to the highest goal scorers, and the size indicates the amount of goals contributed by that player's club.

It is rather interesting to note that Portland Thorns, the club with the most number of international goals (247), has one player Christine Sinclair that contributes to 181 goals for her national team Canada. Without her, Portland Thorns would drop steeply in these rankings, instead of being number 1.

Orlando Pride on the other hand have two major players. Marta (110) and Alex Morgan (101) make up for the majority of international goals for the club. Even though both these clubs from Portland and Orlando are American, among these top 3 scorers only 1 - Alex Morgan, is actually of American nationality. Sinclair and Marta are Canadian and Brazilian respectively.

Lyon, Arsenal, Barcelona and Chelsea have players contributing more equally towards the international goals tally than Portland Thorns and Orlando Pride.

We can conclude in this section alone that in terms of the sheer number of players featuring in the 2019 World Cup, Barcelona has the highest contribution (15), followed by Lyon (177). In terms of goals, however, the American clubs Portland Thorns and Orlando Pride have a massive haul of nearly 500 goals between them, sitting quite comfortably at number 1 and 2 respectively. But Barcelona and Lyon also feature in the top 5 for goals contributed.

## Cap contribution by clubs

Let us now focus on the international experience of players being provided by these clubs, also termed as "caps".

### Contribution by clubs in terms of players' caps

In order to find the clubs providing players with the highest cap value, the "squads.csv" file is sorted in descending order, and the resulting top five clubs are displayed in the Table \@ref(tab:cap).
```{r arrangecapped}
most_capped <- squads %>%
  arrange(desc(caps)) 

```

```{r  cap}
most_capped %>%
  head(5)%>%
  kable(booktabs = TRUE, caption = "Top five clubs that providing most capped players") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

In this table, we could see that the club with the most capped player is Portland Thorns.
We notice that the top five capped players are all over 30 years old! Is there any relationship between caps and the age of players? 
To answer this question, we made a plot of caps changing by age. In Figure \@ref(fig:international)，the purple curve represents the trend of caps with age, while the blue curve represents the trend of conditional mean value of caps with age. 
```{r international, fig.cap="caps changing with age"}
p0 <- ggplot(most_capped,
       aes(x= age, 
           y = caps)) +
  geom_line(color = "purple") +
  geom_smooth(se = FALSE) +
  xlab("Age") +
  ylab("Number of international games") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  ggtitle("The number of international games changing with age") 

ggplotly(p0)
```

Conditional mean refers to the average level of caps predicted under the fixed age, so the characteristics of caps changing with age can be obtained more intuitively by observing the blue line. [@geomsmoothggplot2]It can be seen that the blue line shows an upward trend with the increase of age, that is to say, the older a player is, the more times he participates in international competitions. It's not hard to understand that the older he is, the longer his career may be, the more games he will play.
But we can't help but wonder whether there are players who are both young and highly capped? What club is he from?



### Clubs that provide players that are young and also highly experienced

First of all, we set the age under 25 as "young", and the caps value higher than the mean value belongs to "highly capped", and then it comes to analysis. We then made a summary to get the mean value of caps and the results are in Table \@ref(tab:capyoung). The mean value of caps is 22.45, which means the player with caps higher than 22.5 can be called "highly experienced".
```{r  capyoung}
capped_young <- squads %>%
  filter(age <= 25) %>%
  arrange(desc(caps)) 

capped_young %>%
summary() %>%
  head(5)%>%
  kable(booktabs = TRUE, caption = "Summary of clubs with players under 25 years old") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

Then we select the players whose caps are higher than 22.5, and we present the top five players with their clubs in Table \@ref(tab:five).
It can be seen that clubs Paris Saint-Germain, Lyon and Orlando Pride all provide both young and highly capped players. Specifically, there are two qualified players from the same club Orlando Pride, which means that it may be a club with more young players and places relatively more importance in training newer players.
```{r five}
capped_young_highly <- capped_young %>%
  filter(caps >= 22.15) 

capped_young_highly %>%
  head(5)%>%
  kable(booktabs = TRUE, caption = "Top five clubs providing both young and highly capped players") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```


### Contribution by clubs in terms of player position

Let us now take a look at player positions. Broadly, we have 4 major positions to consider - Goalkeepers (GK), Defenders (DF), Midfielders (MF) and Forwards (FW). Our objective in this section would be to understand which clubs specialize in providing world cup international players in a particular playing position.

```{r play-pos}

GK <- squads %>% 
  filter(pos == "GK") %>% 
  group_by(club) %>% 
  tally() %>% 
  rename(Clubs_Gks = n)

GK_caps <- squads %>% 
  filter(pos == "GK") %>% 
  group_by(club) %>% 
  summarise(Clubs_Gk_caps = sum(caps))

DF <- squads %>% 
  filter(pos == "DF") %>% 
  group_by(club) %>% 
  tally() %>% 
  rename(Clubs_Dfs = n)

DF_caps <- squads %>% 
  filter(pos == "DF") %>% 
  group_by(club) %>% 
  summarise(Clubs_Df_caps = sum(caps))

MF <- squads %>% 
  filter(pos == "MF") %>% 
  group_by(club) %>% 
  tally() %>% 
  rename(Clubs_Mfs = n)

MF_caps <- squads %>% 
  filter(pos == "MF") %>% 
  group_by(club) %>% 
  summarise(Clubs_Mf_caps = sum(caps))

FW <- squads %>% 
  filter(pos == "FW") %>% 
  group_by(club) %>% 
  tally() %>% 
  rename(Clubs_Fws = n)

FW_caps <- squads %>% 
  filter(pos == "FW") %>% 
  group_by(club) %>% 
  summarise(Clubs_Fw_caps = sum(caps))

squads_pos <- squads %>% left_join(GK, by = "club")
squads_pos <- squads_pos %>% left_join(DF, by = "club")
squads_pos <- squads_pos %>% left_join(MF, by = "club")
squads_pos <- squads_pos %>% left_join(FW, by = "club")

squads_pos <- squads_pos %>% left_join(GK_caps, by = "club")
squads_pos <- squads_pos %>% left_join(DF_caps, by = "club")
squads_pos <- squads_pos %>% left_join(MF_caps, by = "club")
squads_pos <- squads_pos %>% left_join(FW_caps, by = "club")

squads_pos[is.na(squads_pos)] <- 0

```

```{r Goalkeepers, fig.cap="Clubs With Goalkeepers Featuring In 2019 WC"}
p2GK <- squads_pos %>%
  filter(Clubs_Gks > 1 | Clubs_Gk_caps >= 61) %>%
  group_by(club) %>% 
  ggplot(aes(club, as.factor(Clubs_Gks), size = Clubs_Gk_caps, color = club)) +
  geom_point() +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  xlab("Clubs") +
  ylab("Number of WC GKs per club") +
  ggtitle("Clubs With Goalkeepers Featuring In 2019 WC") +
  labs(size = "", color = "")

ggplotly(p2GK)
```

Goalkeepers, figure \@ref(fig:Goalkeepers) - Arsenal, Chelsea, Goteborg, Rivers Angels, Vfl Wolfsburg and Vittsjo have 2 goalkeepers that featured in 2019 World Cup. Out of these, Chelsea has the highest cap count of 173 for their two goalkeepers. It is interesting to note that Chelsea's north London neighbours Arsenal also have 2 goalkeepers with a combined cap count of 53. It can be perceived that London is a good city for goalkeepers to play professionally to achieve international success.

```{r Defenders, fig.cap="Clubs With Defenders Featuring In 2019 WC"}
p2DF <- squads_pos %>%
  filter(Clubs_Dfs >= 4 | Clubs_Df_caps >= 214) %>%
  group_by(club) %>% 
  ggplot(aes(club, as.factor(Clubs_Dfs), size = Clubs_Df_caps, color = club)) +
  geom_point() +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  xlab("Clubs") +
  ylab("Number of WC DFs per club") +
  ggtitle("Clubs With Defenders Featuring In 2019 WC") +
  labs(size = "", color = "")

ggplotly(p2DF)
```

Defenders, figure \@ref(fig:Defenders) - Lyon dominates this position. They have a whopping 7 defenders that featured in the 2019 World Cup, with a combined total experience of 475 international caps. Not far behind though is Chelsea with 6 defenders and 404 caps between them.

```{r Midfielders, fig.cap="Clubs With Midfielders Featuring In 2019 WC"}
p2MF <- squads_pos %>%
  filter(Clubs_Mfs >= 3 | Clubs_Mf_caps >= 191) %>%
  group_by(club) %>% 
  ggplot(aes(club, as.factor(Clubs_Mfs), size = Clubs_Mf_caps, color = club)) +
  geom_point() +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  xlab("Clubs") +
  ylab("Number of WC MFs per club") +
  ggtitle("Clubs With Midfielders Featuring In 2019 WC") +
  labs(size = "", color = "")

ggplotly(p2MF)
```

Midfielders, figure \@ref(fig:Midfielders) - Barcelona, Juventus, Manchester City, Nippon TV Beleza, Vfl Wolfsburg and Washington Spirit all have 4 midfielders represented in the 2019 World Cup. Vfl Wolfsburg have the most experience within their 4 midfielders, with a massive 366 caps between them. Paris Saint-Germain has 3 midfielders but a second highest total of caps between them, of 273. Rosengard has only 1 midfielder, the Swedish national Caroline Seger who has 193 caps alone for her country.

```{r Forwards, fig.cap="Clubs With Forwards Featuring In 2019 WC"}
p2FW <- squads_pos %>%
  filter(Clubs_Fws >= 3 | Clubs_Fw_caps >= 181) %>%
  group_by(club) %>% 
  ggplot(aes(club, as.factor(Clubs_Fws), size = Clubs_Fw_caps, color = club)) +
  geom_point() +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  xlab("Clubs") +
  ylab("Number of WC FWs per club") +
  ggtitle("Clubs With Forwards Featuring In 2019 WC") +
  labs(size = "", color = "")

ggplotly(p2FW)
```

Forwards, figure \@ref(fig:Forwards) - Barcelona is the only club that boasts 5 of their forwards featuring in the 2019 World Cup, with a combined experience of 249 caps between them. Portland Thorns has 4 forwards, but their combined experience of 534 caps easily overshadows the rest of the teams. Orlando Pride has only 2 forwards but a cap total of 293, the second highest. Lyon and Bayern Munich feature with 4 forwards as well with 254 and 160 caps respectively. Chelsea and Arsenal feature again, but the American clubs Portland Thorns and Orlando Pride really take the cake here.




# Conclusion

Barcelona and Lyon provide the most number of world cup players, with 15 and 14 respectively. 10 Barcelona players out of those 15 were Spanish, although Spain were eliminated in the round of 16 by the eventual winners - the USA. Lyon provided 7 French nationals in the world cup, and France were eliminated in the quarter finals, again by the USA.

The USA scored a massive 26 goals in the tournament's 7 matches, which can be justified by the fact that just 2 American clubs - Portland Thorns and Orlando Pride, both have nearly 500 international goals between them.

In terms of experience, Christian Sinclair and Carli Lloyd from Portland Thorns and Sky Blue FC (the latter an American club again), are the most capped, with 282 and 271 caps respectively. The top 5 capped players are all above 30 years of age, although there are young players (25 or below) that already have a lot of international experience under their belts, like the 24 year old Chinese midfielder Wang Shuang (93 caps) who plays for Paris Saint-Germain.

In terms of positional contribution, Chelsea dominates goalkeepers with their 2 goalkeepers featuring in the world cup, boasting 173 caps between them. Lyon and Chelsea have 7 and 6 defenders respectively and 475 and 404 caps. Vfl Wolfsburg has 4 midfielders with 366 caps between them. Barcelona has 5 forwards featuring in the world cup who had 249 goals between them, although Spain scored only 4 goals in their 4 matches. Portland Thorns on the other hand had 4 forwards with 534 goals between them, and the USA scored 26 goals in the world cup.

Finally, considering the sheer number of goals scored, the USA deservingly won the world cup, eliminating the likes of Spain, France, England and Netherlands in the process. Netherlands came in second, losing the final to USA and Sweden came in third, beating England in the third place playoffs.

# Acknowledge

The packages used are as follows:


- ggpplot2 [@ggplot2]

- tidyverse [@tidyverse]

- kableExtra [@kableExtra]

- bookdown [@bookdown]

- dplyr [@dplyr]

- plotly [@plotly]


# References


